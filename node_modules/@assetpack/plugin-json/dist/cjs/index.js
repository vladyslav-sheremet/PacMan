'use strict';

var core = require('@assetpack/core');
var fs = require('fs-extra');

function json() {
    return {
        folder: false,
        test(tree) {
            return core.checkExt(tree.path, '.json');
        },
        async post(tree, processor) {
            let json = fs.readFileSync(tree.path, 'utf8');
            try {
                json = JSON.stringify(JSON.parse(json));
            }
            catch (e) {
                core.Logger.warn(`[json] Failed to parse json file: ${tree.path}`);
            }
            processor.saveToOutput({
                tree,
                outputOptions: {
                    outputData: json,
                }
            });
        }
    };
}

exports.json = json;
//# sourceMappingURL=index.js.map
