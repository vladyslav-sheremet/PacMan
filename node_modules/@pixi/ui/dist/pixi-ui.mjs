/*!
 * @pixi/ui - v0.5.0
 * Compiled Thu, 26 Jan 2023 15:42:29 UTC
 *
 * @pixi/ui is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2023, PixiJS Team, All Rights Reserved
 */import{utils as b,Rectangle as V,ObservablePoint as L,Ticker as k,Texture as I,Point as j}from"@pixi/core";import{Signal as d}from"typed-signals";import{Text as x,TextStyle as G}from"@pixi/text";import{Container as p}from"@pixi/display";import{Sprite as f}from"@pixi/sprite";import{Graphics as _}from"@pixi/graphics";import{Group as Y,Tween as A}from"tweedle.js";class S{constructor(t){this.view=t,this.createEvents(),this.enabled=!0}down(t){}up(t){}hover(t){}press(t){}out(t){}upOut(t){}get isDown(){return this._isDown}set enabled(t){this._enabled=t,this.view.interactive=t,this.view.cursor=t?"pointer":"default",t||this._processUp()}get enabled(){return this._enabled}_processUp(t){this._isDown&&this.onUp.emit(this,t),this._isDown=!1}_processUpOut(t){this._isDown&&(this.onUp.emit(this,t),this.onUpOut.emit(this,t)),this._isDown=!1}_processOut(t){this._isMouseIn&&(this._isMouseIn=!1,this.onOut.emit(this,t))}_upOut(t){this.upOut(t)}_out(t){this.out(t)}createEvents(){this.onPress=new d,this.onDown=new d,this.onUp=new d,this.onHover=new d,this.onOut=new d,this.onUpOut=new d,this.view.on("pointerdown",t=>{this._isDown=!0,this.onDown.emit(this,t)}),this.view.on("pointerup",t=>{this._processUp(t)}),this.view.on("pointerupoutside",t=>{this._processUpOut(t)}),this.view.on("pointerout",t=>{this._processOut(t)}),this.view.on("pointertap",t=>{this._isDown=!1,this.onPress.emit(this,t),this.press(t)}),this.view.on("pointerover",t=>{this._isMouseIn=!0,this.onHover.emit(this,t)}),this.onDown.connect((t,i)=>{this.down(i)}),this.onUp.connect((t,i)=>{this.up(i)}),this.onUpOut.connect((t,i)=>{this._upOut(i)}),b.isMobile.any||this.onHover.connect((t,i)=>{this.hover(i)}),this.onOut.connect((t,i)=>{this._out(i)})}}function c(a){return typeof a=="string"?f.from(a):a}class B extends p{constructor(t,i,s=0){super(),this.active=0,this.innerView=new p,this.addChild(this.innerView),this.active=s,t.map((e,n)=>{const h=c(e);return this.innerView.addChild(h),h.visible=n===s,h}),this.onChange=new d,i?Array.isArray(i)?this.triggerEvents=new Set(i):this.triggerEvents=new Set([i]):this.triggerEvents=new Set(["onPress"]),this.events=new S(this),this.events.onPress.connect(()=>this.switch(this.nextActive,"onPress")),this.events.onDown.connect(()=>this.switch(this.nextActive,"onDown")),this.events.onUp.connect(()=>this.switch(this.nextActive,"onUp")),this.events.onHover.connect(()=>this.switch(this.nextActive,"onHover")),this.events.onOut.connect(()=>this.switch(this.nextActive,"onOut")),this.events.onUpOut.connect(()=>this.switch(this.nextActive,"onUpOut"))}get activeView(){return this.views[this.active]}get views(){return this.innerView.children}switch(t,i){if(!this.triggerEvents.has(i))return;this.activeView.visible=!1,this.active=t!==void 0?t:this.nextActive;const s=this.views[this.active];s.visible=!0;const e=this.views.length>2?this.active:this.active===1;this.onChange.emit(e)}forceSwitch(t){this.activeView.visible=!1,this.active=t!==void 0?t:this.nextActive;const i=this.views[this.active];i.visible=!0}get nextActive(){return this.active<this.views.length-1?this.active+1:0}}class E extends B{constructor(t){var i;const s=c(t.style.unchecked),e=c(t.style.checked);super([s,e],["onPress"],t.checked?1:0),this.label=new x((i=t.text)!=null?i:"",t.style.text),this.label.visible=t.text.length>0,this.label.x=s.width+10,this.label.y=(s.height-this.label.height)/2,this.addChild(this.label),this.onCheck=new d,this.onChange.connect(()=>this.onCheck.emit(this.checked))}get checked(){return this.active===1}set checked(t){this.switch(t?1:0,"onPress")}forceCheck(t){this.forceSwitch(t?1:0)}}function P(...a){a.forEach(t=>t&&(t.hitArea=new V))}class T extends p{constructor({bg:t,fill:i,fillOffset:s,progress:e}){var n,h;if(super(),this.progressStart=0,this._progress=0,this.innerView=new p,this.addChild(this.innerView),this.bg=new p,this.bg.addChild(c(t)),this.innerView.addChild(this.bg),i){this.fill=new p,this.fill.addChild(c(i));const o=(n=s==null?void 0:s.x)!=null?n:0,r=(h=s==null?void 0:s.y)!=null?h:0;this.fill.x=(this.bg.width-this.fill.width)/2+o,this.fill.y=(this.bg.height-this.fill.height)/2+r,this.fillMask=new _,this.fill.addChild(this.fillMask),this.fill.mask=this.fillMask,this.addChild(this.fill)}this.progress=e}validate(t){return t=Math.round(t),t<0?0:t>100?100:t}set progress(t){this._progress=this.validate(t);const i=this.bg.width/100*this.progressStart,s=this.bg.width/100*this._progress-i;this.fillMask&&this.fillMask.clear().lineStyle(0).beginFill(16777215).drawRect(i,0,s,this.fill.height)}get progress(){return this._progress}}class U extends T{constructor(t){var i,s,e;super({bg:t.bg,fill:(i=t.fill)!=null?i:t.bg,fillOffset:t.fillOffset}),this.dragging=0,this.min=0,this.max=100,t.slider1&&(this.slider1=this.createSlider(t.slider1),t.showValue&&(this.value1Text=new x("",t.valueTextStyle||{fill:16777215}),this.value1Text.anchor.set(.5),this.addChild(this.value1Text))),t.slider2&&(this.slider2=this.createSlider(t.slider2),t.showValue&&(this.value2Text=new x("",t.valueTextStyle||{fill:16777215}),this.value2Text.anchor.set(.5),this.addChild(this.value2Text))),this.min=(s=t.min)!=null?s:0,this.max=(e=t.max)!=null?e:100,this.activate()}activate(){this.bg.interactive=!0,this.bg.on("pointerdown",this.startUpdate,this).on("globalpointermove",this.update,this).on("pointerup",this.endUpdate,this).on("pointerupoutside",this.endUpdate,this),this.slider1&&(this.slider1.interactive=!0,this.slider1.on("pointerdown",this.startUpdate,this).on("globalpointermove",this.update,this).on("pointerup",this.endUpdate,this).on("pointerupoutside",this.endUpdate,this)),this.slider2&&(this.slider2.interactive=!0,this.slider2.on("pointerdown",this.startUpdate,this).on("globalpointermove",this.update,this).on("pointerup",this.endUpdate,this).on("pointerupoutside",this.endUpdate,this)),P(this.fill,this.value1Text,this.value2Text)}createSlider(t){const i=c(t);i.x=i.width/2;const s=new p;return s.addChild(i),i instanceof f&&i.anchor.set(.5),s.y=this.bg.height/2,this.addChild(s),s}startUpdate(t){this.dragging=1,this.update(t)}endUpdate(){this.dragging&&(this.dragging=0)}update(t){}}class X extends U{constructor(t){var i,s;super(t),this.onChange=new d,this.onUpdate=new d,this.options=t,this.value2=(i=t.value2)!=null?i:this.max,this.value1=(s=t.value1)!=null?s:this.min}get value1(){return this._value1}set value1(t){var i,s,e,n,h;if(t===this._value1)return;t<this.min&&(t=this.min),t>this._value2&&(t=this._value2),this._value1=t,this.updateProgress();const o=(this.max-this.min)/100*t;if(this.slider1.x=(this.bg.width-this.slider1.width)/100*o,this.options.showValue){this.value1Text.text=`${t}`;const r=this.slider1.x+this.slider1.width/2,l=this.slider1.y;this.value1Text.x=r+((s=(i=this.options.valueTextOffset)==null?void 0:i.x)!=null?s:0),this.value1Text.y=l+((n=(e=this.options.valueTextOffset)==null?void 0:e.y)!=null?n:0)}(h=this.onUpdate)==null||h.emit(this.value1,this.value2)}get value2(){return this._value2}set value2(t){var i,s,e,n,h;if(t===this._value2)return;t<this._value1&&(t=this._value1),t>this.max&&(t=this.max),this._value2=t,this.updateProgress();const o=(this.max-this.min)/100*t;if(this.slider2.x=(this.bg.width-this.slider2.width)/100*o,this.options.showValue){this.value2Text.text=`${t}`;const r=this.slider2.x+this.slider2.width/2,l=this.slider2.y;this.value2Text.x=r+((s=(i=this.options.valueTextOffset)==null?void 0:i.x)!=null?s:0),this.value2Text.y=l+((n=(e=this.options.valueTextOffset)==null?void 0:e.y)!=null?n:0)}(h=this.onUpdate)==null||h.emit(this.value1,this.value2)}update(t){if(!this.dragging)return;const i=t.currentTarget,{x:s}=i.parent.worldTransform.applyInverse(t.global),e=Math.abs(s-this.slider1.x-this.slider1.width),n=Math.abs(s-this.slider2.x);this.activeValue||(this.activeValue=e<n?"value1":"value2");const h=this.validate(s/this.bg.width*100);this.activeValue==="value1"?this.value1=(this.max-this.min)/100*h:this.value2=(this.max-this.min)/100*h}endUpdate(){super.endUpdate(),this.activeValue=null}updateProgress(){this.progressStart=(this.max-this.min)/100*this._value1,this.progress=(this.max-this.min)/100*this._value2}}function $(a){return a instanceof x?a:new x(a)}function D(a,t,i=0){let s=t.scale.x,e=t.scale.y;const n=a.width-i*2,h=a.height-i*2,o=n-Math.round(t.width),r=h-Math.round(t.height);o<0&&(s=n/(t.width*s)),r<0&&(e=h/(t.height*e)),(s<=0||e<=0)&&(t.visible=!1),t.scale.set(Math.min(s,e))}const pt=["default","hover","pressed","disabled"];class y extends p{constructor({defaultView:t,hoverView:i,pressedView:s,disabledView:e,text:n,padding:h,offset:o,textOffset:r,iconOffset:l,anchor:u,anchorX:g,anchorY:v,icon:m,animations:w}){var M,O;super(),this.createViews({defaultView:t,hoverView:i,pressedView:s,disabledView:e,text:n,icon:m}),this.anchor=new L(this.resetViewsPositions,this),this.anchor.set((M=g!=null?g:u)!=null?M:0,(O=v!=null?v:u)!=null?O:0),this.padding=h!=null?h:0,this.offset=o,this.textOffset=r,this.iconOffset=l,w&&(this.animations=w,k.shared.add(()=>Y.shared.update())),this.setState("default"),this.addEvents()}set text(t){this.textView||this.createTextView(typeof t=="number"?t.toString():t),this.textView.text=t,this.setState(this.state),this.adjustTextView(this.state)}get text(){var t;return(t=this.textView)==null?void 0:t.text}set enabled(t){this.events.enabled=t,this.setState(t?"default":"disabled")}get enabled(){return this.events.enabled}setState(t){if(this.state===t)return;const i=this.getStateView(this.state),s=this.getStateView(t);i.visible=!1,s.visible=!0,this.state=t,this.setOffset(s,t,this.offset),this.adjustTextView(t),this.adjustIconView(t),this.playAnimations(t)}createTextView(t){this.textView=$(t),this.textView.anchor.set(0)}createIconView(t){this.iconView=c(t)}setOffset(t,i,s){var e,n,h,o,r,l;const u=s?s[i]:{x:0,y:0},g=s==null?void 0:s.default;u?(t.x+=(e=u.x)!=null?e:0,t.y+=(n=u.y)!=null?n:0):g?(t.x+=(h=g.x)!=null?h:0,t.y+=(o=g.y)!=null?o:0):(s.x||s.y)&&(t.x+=(r=s.x)!=null?r:0,t.y+=(l=s.y)!=null?l:0)}getStateView(t){var i,s,e;switch(t){case"hover":return(i=this.hoverView)!=null?i:this.defaultView;case"pressed":return(s=this.pressedView)!=null?s:this.defaultView;case"disabled":return(e=this.disabledView)!=null?e:this.defaultView;case"default":default:return this.defaultView}}adjustTextView(t){if(!this.textView)return;const i=this.getStateView(this.state);D(i,this.textView,this.padding),i.addChild(this.textView),this.textView.x=(i.width-this.textView.width)/2,this.textView.y=(i.height-this.textView.height)/2,this.setOffset(this.textView,t,this.textOffset)}adjustIconView(t){if(!this.iconView)return;const i=this.getStateView(this.state);D(i,this.iconView,this.padding),i.addChild(this.iconView),this.iconView.x=i.width/2-this.iconView.width/2,this.iconView.y=i.height/2-this.iconView.height/2,this.setOffset(this.iconView,t,this.iconOffset)}resetViewsPositions(){var t,i,s,e;const n=(i=(t=this.anchor)==null?void 0:t.x)!=null?i:0,h=(e=(s=this.anchor)==null?void 0:s.y)!=null?e:0;[this.defaultView,this.hoverView,this.pressedView,this.disabledView].forEach(o=>{var r;o&&((r=o.anchor)==null||r.set(0),o.x=-o.width*n,o.y=-o.height*h)})}createViews(t){const{defaultView:i,hoverView:s,pressedView:e,disabledView:n,text:h,icon:o}=t;this.innerView=new p,this.addChild(this.innerView),this.defaultView=c(i),this.innerView.addChild(this.defaultView),s&&(this.hoverView=c(s),this.innerView.addChild(this.hoverView),this.hoverView.visible=!1),e&&(this.pressedView=c(e),this.innerView.addChild(this.pressedView),this.pressedView.visible=!1),n&&(this.disabledView=c(n),this.innerView.addChild(this.disabledView),this.disabledView.visible=!1),h&&this.createTextView(h),o&&this.createIconView(o)}addEvents(){this.events=new S(this),this.onPress=new d,this.onDown=new d,this.onUp=new d,this.onHover=new d,this.onOut=new d,this.onUpOut=new d,this.events.onPress.connect((t,i)=>{this.onPress.emit(this,i),this.setState("hover")}),this.events.onDown.connect((t,i)=>{this.onDown.emit(this,i),this.setState("pressed")}),this.events.onUp.connect((t,i)=>{this.onUp.emit(this,i),this.setState("hover")}),this.events.onHover.connect((t,i)=>{this.onHover.emit(this,i),this.setState("hover")}),this.events.onOut.connect((t,i)=>{this.onOut.emit(this,i),this.setState("default")}),this.events.onUpOut.connect((t,i)=>{this.onUpOut.emit(this,i),this.setState("default")})}playAnimations(t){if(this.originalInnerViewState||(this.originalInnerViewState={x:this.innerView.x,y:this.innerView.y,width:this.innerView.width,height:this.innerView.height,scale:{x:this.innerView.scale.x,y:this.innerView.scale.y}}),this.animations&&this.animations[t]){const i=this.animations[t];new A(this.innerView).to(i.props,i.duration).start()}else this.animations&&t==="default"&&new A(this.innerView).to(this.originalInnerViewState,100).start()}}class N extends p{constructor(t){var i,s;super(),this.editing=!1,this.tick=0,this.activation=!1,this.options=t,this.bg=c(t.bg),this.bg.cursor="text",this.bg.interactive=!0;const e={fill:0,align:"center"},n=new G((i=t.textStyle)!=null?i:e);if(this.inputField=new x("",n),this.inputMask=new _().beginFill(16777215).drawRect(this.padding,this.padding,this.bg.width-this.padding*2,this.bg.height-this.padding*2),this.inputField.mask=this.inputMask,this._cursor=new f(I.WHITE),this._cursor.tint=Number(t.textStyle.fill)||0,this._cursor.anchor.set(.5),this._cursor.width=2,this._cursor.height=this.inputField.height*.8,this._cursor.alpha=0,this._cursor.mask=this.inputMask,this.placeholder=new x(t.placeholder,n!=null?n:e),this.placeholder.visible=!!t.placeholder,this.value=(s=t.value)!=null?s:"",this.addChild(this.bg,this.inputField,this.placeholder,this._cursor,this.inputMask),this.align(),this.cursor="text",this.interactive=!0,this.on("pointertap",()=>this.activation=!0),b.isMobile.any){window.addEventListener("touchstart",()=>this.handleActivation());let h=document.getElementById("v-keyboard");h||(h=document.createElement("input"),document.body.appendChild(h),h.setAttribute("id","v-keyboard"),h.style.opacity="0"),h.oninput=()=>{let o=h.value;const r=this.options.maxLength;r&&o.length>this.options.maxLength&&(o=o.substring(0,r),h.value=o),this.value=o,this.onChange.emit(this.value)}}else window.addEventListener("click",()=>{this.handleActivation(),this.onEnter.emit(this.value)}),window.addEventListener("keydown",h=>{const o=h.key;o==="Backspace"?this._delete():o==="Escape"||o==="Enter"?(this.stopEditing(),this.onEnter.emit(this.value)):o.length===1&&this._add(o)});this.onEnter=new d,this.onChange=new d,k.shared.add(h=>this.update(h))}_add(t){this.editing&&(this.options.maxLength&&this.value.length>=this.options.maxLength||(this.value=this.value+t,this.onChange.emit(this.value)))}_delete(){if(!this.editing||this.value.length===0)return;const t=this.value.split("");t.pop(),this.value=t.join(""),this.onChange.emit(this.value)}_startEditing(){if(this.tick=0,this.editing=!0,this.placeholder.visible=!1,this._cursor.alpha=1,b.isMobile.any){const t=document.getElementById("v-keyboard");t.focus(),t.click(),t.value=this.value}this.align()}handleActivation(){this.stopEditing(),this.activation&&(this._startEditing(),this.activation=!1)}stopEditing(){var t;this._cursor.alpha=0,this.editing=!1,this.inputField.text===""&&(this.placeholder.visible=!0),this.value.length===0&&(this.placeholder.visible=!0),b.isMobile.any&&((t=document.getElementById("v-keyboard"))==null||t.blur()),this.align()}update(t){this.editing&&(this.tick+=t*.1,this._cursor.alpha=Math.round(Math.sin(this.tick)*.5+.5))}align(){const t=this.getAlign();this.inputField.anchor.set(t,.5),this.inputField.x=this.bg.width*t+(t===1?-this.padding:this.padding),this.inputField.y=this.bg.height/2,this.placeholder.anchor.set(t,.5),this.placeholder.x=this.bg.width*t+(t===1?-this.padding:this.padding),this.placeholder.y=this.bg.height/2,this._cursor.x=this.getCursorPosX(),this._cursor.y=this.inputField.y}get padding(){return this.options.padding|0}getAlign(){const t=this.bg.width*.95;if(this.inputField.width+this.padding*3>t)return this.editing?1:0;switch(this.options.align){case"left":return 0;case"center":return .5;case"right":return 1;default:return 0}}getCursorPosX(){switch(this.getAlign()){case 0:return this.inputField.x+this.inputField.width;case .5:return this.inputField.x+this.inputField.width*.5;case 1:return this.inputField.x;default:return 0}}set value(t){this.inputField.text=t,t.length!==0?this.placeholder.visible=!1:this.placeholder.visible=!this.editing,this.align()}get value(){return this.inputField.text}}class C extends p{constructor(t){super(),this.children=[],this.options=t,t!=null&&t.type&&(this.type=t.type),t!=null&&t.children&&t.children.map(i=>this.addChild(i))}onChildrenChange(){var t,i,s,e,n,h;let o=(i=(t=this.options)==null?void 0:t.horPadding)!=null?i:0,r=(e=(s=this.options)==null?void 0:s.vertPadding)!=null?e:0;const l=(h=(n=this.options)==null?void 0:n.elementsMargin)!=null?h:0;this.children.forEach(u=>{var g,v;switch(!this.type&&o+u.width>=this.parent.width?(r+=l+u.height,o=(v=(g=this.options)==null?void 0:g.horPadding)!=null?v:0,u.x=o,u.y=r):(u.x=o,u.y=r),this.type){case"horizontal":o+=l+u.width;break;case"vertical":r+=l+u.height;break;default:o+=l+u.width;break}})}}class q extends _{constructor({target:t,mask:i,borderWidth:s,borderColor:e}){if(super(),this.borderColor=e,this.borderWidth=s,this.target=c(t),this.targetMask=c(i),this.target.addChild(this.targetMask),this.target.mask=this.targetMask,s){this.showBorder(),this.target.x=s,this.target.y=s;const n=typeof i=="string"?new f(I.from(i)):i.clone();n.width+=s*2,n.height+=s*2,this.mask=n,this.addChild(n)}this.addChild(this.target)}showBorder(){this.beginFill(this.borderColor);const t=this.borderWidth*2;this.drawRect(0,0,this.target.width+t,this.target.height+t)}hideBorder(){this.clear()}}class J extends p{constructor(t){super(),this.items=[],this.options=t,this.value=t.items[t.selectedItem],this.selected=t.selectedItem,this.innerView=new C({type:t.type,elementsMargin:t.elementsMargin}),t.items.forEach((i,s)=>{const e=this.getView(t.style.bg),n=this.getView(t.style.checked),h=new E({text:i,checked:t.selectedItem===s,style:{unchecked:e,checked:n,text:t.style.textStyle}});this.innerView.addChild(h),h.onChange.connect(()=>this.selectItem(s)),this.items.push(h),this.innerView.addChild(h)}),this.onChange=new d}getView(t){return typeof t=="string"?f.from(t):this.getGraphics(t)}getGraphics({color:t,fillColor:i,width:s,height:e,radius:n,padding:h}){const o=new _().beginFill(t),r=s===e&&n>=s/2;if(r?o.drawCircle(s/2,s/2,s/2):o.drawRoundedRect(0,0,s,e,n),i!==void 0){o.beginFill(i);const l=s/2;r?o.drawCircle(l,l,l-h):o.drawRoundedRect(h,h,s-h*2,e-h*2,n)}return o}selectItem(t){this.items.forEach((i,s)=>{i.forceCheck(s===t)}),this.value=this.options.items[t],this.selected!==t&&this.onChange.emit(t,this.value),this.selected=t}}class K{constructor(t={}){this.x=0,this.ax=0,this.dx=0,this.tx=0,this._options=t,this._options.max=t.max||160,this._options.damp=t.damp||.8,this._options.springiness=t.springiness||.1}update(){this.ax=(this.tx-this.x)*this._options.springiness,this.dx+=this.ax,this.dx*=this._options.damp,this.dx<-this._options.max?this.dx=-this._options.max:this.dx>this._options.max&&(this.dx=this._options.max),this.x+=this.dx}reset(){this.x=0,this.ax=0,this.dx=0,this.tx=0}get max(){return this._options.max}set max(t){this._options.max=t}get damp(){return this._options.damp}set damp(t){this._options.damp=t}get springiness(){return this._options.springiness}set springiness(t){this._options.springiness=t}}class F{constructor(){this._spring=new K,this._pos=0,this.to=0}start(t,i,s){this._speed=t,this._pos=i,this.to=s,this.done=!1,this._spring.x=this._pos,this._spring.tx=this.to;const e=this.to-this._pos,n=Math.abs(e)/e,h=Math.abs(this._speed)/this._speed;n!==h?this._correctSpeed=!0:this._correctSpeed=!1}update(){if(this._correctSpeed)this._speed*=.6,Math.abs(this._speed)<2&&(this._correctSpeed=!1),this._pos+=this._speed,this._spring.x=this._pos;else{const t=this.to-this._pos;Math.abs(t)<.05?(this._pos=this.to,this.done=!0):(this._spring.tx=this.to,this._spring.update(),this._pos=this._spring.x)}return this._pos}cancel(){}}class H{constructor(t={}){this.position=0,this.constrain=!0,this.min=0,this.max=0,this.maxSpeed=400,this._offset=0,this._prev=0,this._speed=0,this._targetSpeed=0,this._speedChecker=0,this._grab=0;var i,s,e;this.constrain=(i=t.constrain)!=null?i:!0,this.maxSpeed=(s=t.maxSpeed)!=null?s:400,this._ease=(e=t.ease)!=null?e:new F}set value(t){this._speed=0,this.position=t}get value(){return this.position}grab(t){this._grab=t,this._offset=this.position-t,this._speedChecker=0,this._targetSpeed=this._speed=0,this._hasStopped=!1}hold(t){this._speedChecker++,this.position=t+this._offset,this._speedChecker>1&&(this._targetSpeed=this.position-this._prev),this._speed+=(this._targetSpeed-this._speed)/2,this._speed>this.maxSpeed?this._speed=this.maxSpeed:this._speed<-this.maxSpeed&&(this._speed=-this.maxSpeed),this._prev=this.position,this.constrain&&(this._activeEase=null,this.position>this.min?this.position-=(this.position-this.min)/1.5:this.position<this.max&&(this.position+=(this.max-this.position)/1.5))}slide(){this._hasStopped||(this.constrain?this._updateConstrain():this._updateDefault())}get moveAmount(){return-(this.position-this._offset-this._grab)}_updateDefault(){this._speed*=.9,this.position+=this._speed,(this._speed<0?this._speed*-1:this._speed)<.01&&(this._hasStopped=!0)}_updateConstrain(){const t=this.max;this.position>this.min||this.position<t||this._activeEase?(this._activeEase||(this._activeEase=this._ease,this.position>this.min?this._activeEase.start(this._speed,this.position,this.min):this._activeEase.start(this._speed,this.position,t)),this.position=this._activeEase.update(),this._activeEase.done&&(this.position=this._activeEase.to,this._speed=0,this._activeEase=null)):this._updateDefault()}}class Q{constructor(t){this.xAxis=new H({ease:t.xEase,maxSpeed:t.maxSpeed,constrain:t.constrain}),this.yAxis=new H({ease:t.yEase,maxSpeed:t.maxSpeed,constrain:t.constrain}),this._frame=new V,this._bounds=new V,this._globalPosition=new j}pointerDown(t){this.xAxis.grab(t.x),this.yAxis.grab(t.y),this._isDown=!0}pointerUp(){this._isDown=!1}pointerMove(t){this._globalPosition=t}update(){this._dirty&&(this._dirty=!1,this.xAxis.min=this._bounds.left,this.xAxis.min=this._bounds.right-this._frame.width,this.xAxis.min=this._bounds.top,this.xAxis.min=this._bounds.bottom-this._frame.height),this._isDown?(this.xAxis.hold(this._globalPosition.x),this.yAxis.hold(this._globalPosition.y)):(this.xAxis.slide(),this.yAxis.slide())}resize(t,i){this._frame.x=0,this._frame.width=t,this._frame.y=0,this._frame.height=i,this._dirty=!0}setBounds(t,i,s,e){this._bounds.x=t,this._bounds.width=i-t,this._bounds.y=s,this._bounds.height=e-s,this._dirty=!0}get x(){return this.xAxis.value}get y(){return this.yAxis.value}}class R extends p{constructor(t){var i,s,e;super(),this.__width=0,this.__height=0,this.freeSlot={x:0,y:0},this.isDragging=0,this.childrenInteractiveStorage=[],this.ticker=k.shared,this.options=t,this.addBackground(),this.__width=t.width|this.background.width,this.__height=t.height|this.background.height,t.vertPadding||(t.vertPadding=(i=t.padding)!=null?i:0),t.horPadding||(t.horPadding=(s=t.padding)!=null?s:0),this.layout=new C({type:t.type,elementsMargin:t.elementsMargin,vertPadding:t.vertPadding,horPadding:t.horPadding}),super.addChild(this.layout),(e=t.items)!=null&&e.length&&t.items.forEach(h=>{this.addItem(h)}),this.hasBounds&&(this.addMask(),this.makeScrollable()),this.onMouseScrollBinded=this.onMouseScroll.bind(this);const n=new F;this._trackpad=new Q({constrain:!0,yEase:n}),this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0,this.resize(),this.ticker.add(this.update,this)}get hasBounds(){return!!this.__width||!!this.__height}onChildrenChange(){}addItem(...t){var i,s;if(t.length>1)t.forEach(e=>this.addItem(e));else{const e=t[0];(!e.width||!e.height)&&console.error("ScrollBox item should have size"),e.x=this.freeSlot.x,e.y=this.freeSlot.y,this.layout.addChild(e),this.options.disableDynamicRendering||(e.renderable=this.isItemVisible(e));const n=(s=(i=this.options)==null?void 0:i.elementsMargin)!=null?s:0;switch(this.options.type){case"horizontal":this.freeSlot.x+=n+e.width;break;default:this.freeSlot.y+=n+e.height;break}}return this.resize(),t[0]}removeItem(t){const i=this.layout.children[t];i&&(this.layout.removeChild(i),this.resize())}isItemVisible(t){const i=this.options.type==="vertical"||!this.options.type;let s=!1;const e=this.layout;if(i){const n=t.y+e.y;n+t.height+this.options.vertPadding>=0&&n-this.options.vertPadding-this.options.elementsMargin<=this.options.height&&(s=!0)}else{const n=t.x+e.x;n+t.width>=0&&n<=this.options.width&&(s=!0)}return s}get items(){var t,i;return(i=(t=this.layout)==null?void 0:t.children)!=null?i:[]}addBackground(){this.background=typeof this.options.background=="string"?f.from(this.options.background):new _,this.addChild(this.background),this.resize()}addMask(){this.borderMask=new _,super.addChild(this.borderMask),this.mask=this.borderMask,this.resize()}makeScrollable(){this.on("pointerdown",s=>{this.isDragging=1,this._trackpad.pointerDown(s.global)}),this.on("pointerup",()=>{this.isDragging=0,this._trackpad.pointerUp(),this.restoreChildrenInteractivity()}),this.on("pointerupoutside",()=>{this.isDragging=0,this._trackpad.pointerUp(),this.restoreChildrenInteractivity()}),this.on("globalpointermove",s=>{this._trackpad.pointerMove(s.global),this.isDragging&&this.disableChildrenInteractivity()});const{onMouseHover:t,onMouseOut:i}=this;this.on("mouseover",t,this).on("mouseout",i,this)}disableChildrenInteractivity(){this.items.forEach((t,i)=>{this.childrenInteractiveStorage[i]||(this.childrenInteractiveStorage[i]=t.interactive===!0),t.interactive=!1})}restoreChildrenInteractivity(){this.items.forEach((t,i)=>{const s=this.childrenInteractiveStorage[i]===!0;s&&(t.interactive=s,delete this.childrenInteractiveStorage[i])})}setInteractive(t){this.interactive=t}get layoutHeight(){return this.layout.height+this.options.vertPadding*2}get layoutWidth(){return this.layout.width+this.options.horPadding*2}resize(){if(this.renderAllItems(),this.borderMask&&(this.lastWidth!==this.layoutWidth||this.lastHeight!==this.layoutHeight)){const t=this.options.vertPadding,i=this.options.horPadding;this.options.width||(this.__width+=this.layoutWidth),this.options.height||(this.__height+=this.layoutHeight),this.borderMask.clear().lineStyle(0).beginFill(16777215).drawRoundedRect(0,0,this.__width,this.__height,this.options.radius|0),P(this.borderMask),this.background instanceof _&&typeof this.options.background=="number"&&this.background.clear().lineStyle(0).beginFill(this.options.background).drawRect(0,0,this.__width+i,this.__height+t),this.options.type==="horizontal"?this.setInteractive(this.layoutWidth>this.__width):this.setInteractive(this.layoutHeight>this.__height),this.lastWidth=this.layoutWidth,this.lastHeight=this.layoutHeight}if(this._trackpad){const t=this.borderMask.width-this.layout.width-this.options.horPadding*2,i=this.borderMask.height-this.layout.height-this.options.vertPadding*2;this.options.type==="vertical"?this._trackpad.yAxis.max=-Math.abs(i):this.options.type==="horizontal"?this._trackpad.xAxis.max=-Math.abs(t):(this._trackpad.yAxis.max=-Math.abs(i),this._trackpad.xAxis.max=-Math.abs(t))}this.stopRenderHiddenItems()}onMouseHover(){this.renderAllItems(),document.addEventListener("mousewheel",this.onMouseScrollBinded),document.addEventListener("DOMMouseScroll",this.onMouseScrollBinded)}onMouseOut(){this.stopRenderHiddenItems(),document.removeEventListener("mousewheel",this.onMouseScrollBinded),document.removeEventListener("DOMMouseScroll",this.onMouseScrollBinded)}onMouseScroll(t){if(this.renderAllItems(),this.options.type==="horizontal"&&(typeof t.deltaX!="undefined"||typeof t.deltaY!="undefined")){const i=t.deltaY?this.layout.x-t.deltaY:this.layout.x-t.deltaX;i<0&&i+this.layoutWidth+this.options.horPadding<this.__width?this._trackpad.xAxis.value=this.__width-this.layoutWidth:i>this.options.horPadding?this._trackpad.xAxis.value=0:this._trackpad.xAxis.value=i}else if(typeof t.deltaY!="undefined"){const i=this.layout.y-t.deltaY;i<0&&i+this.layoutHeight+this.options.vertPadding<this.__height?this._trackpad.yAxis.value=this.__height-this.layoutHeight:i>this.options.vertPadding?this._trackpad.yAxis.value=0:this._trackpad.yAxis.value=i}this.stopRenderHiddenItems()}scrollBottom(){this.interactive?this.scrollTo(this.layout.children.length-1):this.scrollTop()}scrollTop(){this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0}renderAllItems(){this.options.disableDynamicRendering||this.items.forEach(t=>{t.renderable=!0})}stopRenderHiddenItems(){this.options.disableDynamicRendering||this.items.forEach(t=>{t.renderable=this.isItemVisible(t)})}scrollTo(t){if(!this.interactive)return;const i=this.layout.children[t];i&&(this._trackpad.xAxis.value=this.options.type==="horizontal"?this.__width-i.x-i.width-this.options.horPadding:0,this._trackpad.yAxis.value=!this.options.type||this.options.type==="vertical"?this.__height-i.y-i.height-this.options.vertPadding:0)}get height(){return this.__height}get width(){return this.__width}update(){this._trackpad.update(),this.options.type==="horizontal"?this.layout.x!==this._trackpad.x?(this.renderAllItems(),this.layout.x=this._trackpad.x):this.stopRenderHiddenItems():this.layout.y!==this._trackpad.y?(this.renderAllItems(),this.layout.y=this._trackpad.y):this.stopRenderHiddenItems()}}var Z=Object.defineProperty,z=Object.getOwnPropertySymbols,tt=Object.prototype.hasOwnProperty,it=Object.prototype.propertyIsEnumerable,W=(a,t,i)=>t in a?Z(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,st=(a,t)=>{for(var i in t||(t={}))tt.call(t,i)&&W(a,i,t[i]);if(z)for(var i of z(t))it.call(t,i)&&W(a,i,t[i]);return a};const et=5;class ht extends p{constructor({closedBG:t,textStyle:i,items:s,openBG:e,selected:n,selectedTextOffset:h,scrollBox:o,visibleItems:r}){var l,u;super(),this.openButton=new y({defaultView:c(t),text:new x(s!=null&&s.items?s.items[0]:"",i),textOffset:h}),this.openButton.onPress.connect(()=>this.toggle()),this.addChild(this.openButton),this.openView=c(e),this.openView.visible=!1,this.addChild(this.openView);const g=new _().beginFill(0,1e-5).drawRect(0,0,this.openButton.width,this.openButton.height);this.closeButton=new y({defaultView:g,text:new x(s!=null&&s.items?s.items[0]:"",i),textOffset:h}),this.closeButton.onPress.connect(()=>this.toggle()),this.openView.addChild(this.closeButton),this.scrollBox=new R(st({type:"vertical",elementsMargin:0,width:this.openButton.width,height:this.openButton.height*(r!=null?r:et),radius:0,padding:0},o)),this.scrollBox.y=this.openButton.height,this.openView.addChild(this.scrollBox),o!=null&&o.offset&&(this.scrollBox.x+=(l=o.offset.x)!=null?l:0,this.scrollBox.y+=(u=o.offset.y)!=null?u:0),this.onSelect=new d,this.convertItemsToButtons(s).forEach((v,m)=>{const w=v.text;m===n&&(this.openButton.text=w,this.closeButton.text=w),v.onPress.connect(()=>{this.value=m,this.onSelect.emit(m,w),this.openButton.text=w,this.closeButton.text=w,this.close()}),this.scrollBox.addItem(v)})}toggle(){this.openView.visible=!this.openView.visible,this.openButton.visible=!this.openButton.visible}open(){this.openView.visible=!0,this.openButton.visible=!1}close(){this.openView.visible=!1,this.openButton.visible=!0}convertItemsToButtons({items:t,backgroundColor:i,hoverColor:s,width:e,height:n,textStyle:h,radius:o}){const r=[];return t.forEach(l=>{const u=new _().beginFill(i).drawRoundedRect(0,0,e,n,o),g=s!=null?s:i,v=new _().beginFill(g).drawRoundedRect(0,0,e,n,o),m=new x(l,h),w=new y({defaultView:u,hoverView:v,text:m});r.push(w)}),r}}class nt extends U{constructor(t){var i,s;super({bg:t.bg,slider1:t.slider,fill:(i=t.fill)!=null?i:"",min:t.min,max:t.max,value1:t.value,valueTextStyle:t.valueTextStyle,showValue:t.showValue,valueTextOffset:t.valueTextOffset,fillOffset:t.fillOffset}),this.onChange=new d,this.onUpdate=new d,this.options=t,this.value=(s=t.value)!=null?s:0}get value(){return this._value1}set value(t){var i,s,e,n,h;if(t!==this._value1){if(t<this.min&&(t=this.min),t>this.max&&(t=this.max),this._value1=t,this.progress=(this.max-this.min)/100*t,this.slider1.x=(this.bg.width-this.slider1.width)/100*this.progress,this.options.showValue){this.value1Text.text=`${t}`;const o=this.slider1.x+this.slider1.width/2,r=this.slider1.y;this.value1Text.x=o+((s=(i=this.options.valueTextOffset)==null?void 0:i.x)!=null?s:0),this.value1Text.y=r+((n=(e=this.options.valueTextOffset)==null?void 0:e.y)!=null?n:0)}(h=this.onUpdate)==null||h.emit(this.value)}}update(t){if(!this.dragging)return;const i=t.currentTarget,{x:s}=i.parent.worldTransform.applyInverse(t.global),e=this.validate(s/this.bg.width*100);e!==this.progress&&(this.value=(this.max-this.min)/100*e)}}export{S as Button,E as CheckBox,X as DoubleSlider,y as FancyButton,N as Input,C as Layout,q as MaskedFrame,T as ProgressBar,J as RadioGroup,R as ScrollBox,ht as Select,nt as Slider,B as Switcher};
//# sourceMappingURL=pixi-ui.mjs.map
