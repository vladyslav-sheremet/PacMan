{"version":3,"file":"ScrollBox.mjs","sources":["../src/ScrollBox.ts"],"sourcesContent":["import { Ticker } from '@pixi/core';\nimport { Container } from '@pixi/display';\nimport { FederatedPointerEvent } from '@pixi/events';\nimport { Graphics } from '@pixi/graphics';\nimport { Sprite } from '@pixi/sprite';\nimport type { LayoutType } from './Layout';\nimport { Layout } from './Layout';\nimport { removeHitBox } from './utils/helpers/hitbox';\nimport ScrollSpring from './utils/trackpad/ScrollSpring';\nimport { Trackpad } from './utils/trackpad/Trackpad';\n\nexport type ScrollBoxOptions = {\n    type?: LayoutType;\n    background?: number | string;\n    width?: number;\n    height?: number;\n    radius?: number;\n    elementsMargin?: number;\n    items?: Container[];\n    disableDynamicRendering?: boolean;\n    vertPadding?: number;\n    horPadding?: number;\n    padding?: number;\n};\n\n/**\n * Scrollable view, for arranging lists of Pixi container-based elements.\n *\n * Items, that are out of the visible area, are not rendered.\n * @example\n * ```\n * new ScrollBox({\n *     background: 0XFFFFFF,\n *     items: [\n *         new Graphics().beginFill(0x000000).drawRect(0, 0, 200, 50),\n *         new Graphics().beginFill(0x000000).drawRect(0, 0, 200, 50),\n *         new Graphics().beginFill(0x000000).drawRect(0, 0, 200, 50),\n *         new Graphics().beginFill(0x000000).drawRect(0, 0, 200, 50),\n *         new Graphics().beginFill(0x000000).drawRect(0, 0, 200, 50),\n *         new Graphics().beginFill(0x000000).drawRect(0, 0, 200, 50),\n *         new Graphics().beginFill(0x000000).drawRect(0, 0, 200, 50),\n *     ],\n * });\n * ```\n */\n\nexport class ScrollBox extends Container\n{\n    private background: Graphics | Sprite;\n    private borderMask: Graphics;\n    private lastWidth: number;\n    private lastHeight: number;\n    private __width = 0;\n    private __height = 0;\n\n    private readonly onMouseScrollBinded: (event: any) => void;\n\n    private readonly layout: Layout;\n\n    private readonly freeSlot = {\n        x: 0,\n        y: 0,\n    };\n\n    private _trackpad: Trackpad;\n    private isDragging = 0;\n    private childrenInteractiveStorage: boolean[] = [];\n    private ticker = Ticker.shared;\n    private readonly options: ScrollBoxOptions;\n\n    constructor(options: ScrollBoxOptions)\n    {\n        super();\n\n        this.options = options;\n        this.addBackground();\n\n        this.__width = options.width | this.background.width;\n        this.__height = options.height | this.background.height;\n\n        if (!options.vertPadding)\n        {\n            options.vertPadding = options.padding ?? 0;\n        }\n\n        if (!options.horPadding)\n        {\n            options.horPadding = options.padding ?? 0;\n        }\n\n        this.layout = new Layout({\n            type: options.type,\n            elementsMargin: options.elementsMargin,\n            vertPadding: options.vertPadding,\n            horPadding: options.horPadding,\n        });\n\n        super.addChild(this.layout);\n\n        if (options.items?.length)\n        {\n            options.items.forEach((item) =>\n            {\n                this.addItem(item);\n            });\n        }\n\n        if (this.hasBounds)\n        {\n            this.addMask();\n            this.makeScrollable();\n        }\n\n        this.onMouseScrollBinded = this.onMouseScroll.bind(this);\n\n        const spring = new ScrollSpring();\n\n        this._trackpad = new Trackpad({\n            constrain: true,\n            yEase: spring,\n        });\n\n        this._trackpad.xAxis.value = 0;\n        this._trackpad.yAxis.value = 0;\n\n        this.resize();\n\n        this.ticker.add(this.update, this);\n    }\n\n    private get hasBounds(): boolean\n    {\n        return !!this.__width || !!this.__height;\n    }\n\n    protected override onChildrenChange()\n    {\n        // do nothing we manage this in addItem\n    }\n\n    /**\n     * Adds an item to a scrollable list.\n     * @param {...any} items\n     */\n    public addItem<T extends Container[]>(...items: T): T[0]\n    {\n        if (items.length > 1)\n        {\n            items.forEach((item) => this.addItem(item));\n        }\n        else\n        {\n            const child = items[0];\n\n            if (!child.width || !child.height)\n            {\n                console.error('ScrollBox item should have size');\n            }\n\n            child.x = this.freeSlot.x;\n            child.y = this.freeSlot.y;\n\n            this.layout.addChild(child);\n\n            if (!this.options.disableDynamicRendering)\n            {\n                child.renderable = this.isItemVisible(child);\n            }\n\n            const elementsMargin = this.options?.elementsMargin ?? 0;\n\n            switch (this.options.type)\n            {\n                case 'horizontal':\n                    this.freeSlot.x += elementsMargin + child.width;\n                    break;\n\n                default:\n                    this.freeSlot.y += elementsMargin + child.height;\n                    break;\n            }\n        }\n\n        this.resize();\n\n        return items[0];\n    }\n\n    /**\n     * Removes an item from a scrollable list.\n     * @param itemID\n     */\n    public removeItem(itemID: number)\n    {\n        const child = this.layout.children[itemID];\n\n        if (!child)\n        {\n            return;\n        }\n\n        this.layout.removeChild(child);\n\n        this.resize();\n    }\n\n    /**\n     * Checks if the item is visible or scrolled out of the visible part of the view.* Adds an item to a scrollable list.\n     * @param item\n     */\n    public isItemVisible(item: Container): boolean\n    {\n        const isVertical = this.options.type === 'vertical' || !this.options.type;\n        let isVisible = false;\n        const layout = this.layout;\n\n        if (isVertical)\n        {\n            const posY = item.y + layout.y;\n\n            if (\n                posY + item.height + this.options.vertPadding >= 0\n                && posY - this.options.vertPadding - this.options.elementsMargin <= this.options.height\n            )\n            {\n                isVisible = true;\n            }\n        }\n        else\n        {\n            const posX = item.x + layout.x;\n\n            if (posX + item.width >= 0 && posX <= this.options.width)\n            {\n                isVisible = true;\n            }\n        }\n\n        return isVisible;\n    }\n\n    /** Returns all inner items in a list. */\n    public get items(): Container[] | []\n    {\n        return this.layout?.children ?? [];\n    }\n\n    private addBackground()\n    {\n        this.background = typeof this.options.background === 'string'\n            ? Sprite.from(this.options.background)\n            : new Graphics();\n\n        this.addChild(this.background);\n\n        this.resize();\n    }\n\n    private addMask()\n    {\n        this.borderMask = new Graphics();\n        super.addChild(this.borderMask);\n        this.mask = this.borderMask;\n        this.resize();\n    }\n\n    private makeScrollable()\n    {\n        this.on('pointerdown', (e: FederatedPointerEvent) =>\n        {\n            this.isDragging = 1;\n            this._trackpad.pointerDown(e.global);\n        });\n\n        this.on('pointerup', () =>\n        {\n            this.isDragging = 0;\n            this._trackpad.pointerUp();\n            this.restoreChildrenInteractivity();\n        });\n\n        this.on('pointerupoutside', () =>\n        {\n            this.isDragging = 0;\n            this._trackpad.pointerUp();\n            this.restoreChildrenInteractivity();\n        });\n\n        this.on('globalpointermove', (e: FederatedPointerEvent) =>\n        {\n            this._trackpad.pointerMove(e.global);\n\n            if (this.isDragging)\n            {\n                this.disableChildrenInteractivity();\n            }\n        });\n\n        const { onMouseHover, onMouseOut } = this;\n\n        this.on('mouseover', onMouseHover, this).on('mouseout', onMouseOut, this);\n    }\n\n    private disableChildrenInteractivity()\n    {\n        // prevent clicks on buttons\n        this.items.forEach((item, itemID) =>\n        {\n            if (!this.childrenInteractiveStorage[itemID])\n            {\n                this.childrenInteractiveStorage[itemID]\n                    = item.interactive === true;\n            }\n\n            item.interactive = false;\n        });\n    }\n\n    private restoreChildrenInteractivity()\n    {\n        // restore clicks on buttons\n        this.items.forEach((item, itemID) =>\n        {\n            const wasItemInteractive\n                = this.childrenInteractiveStorage[itemID] === true;\n\n            if (wasItemInteractive)\n            {\n                item.interactive = wasItemInteractive;\n\n                delete this.childrenInteractiveStorage[itemID];\n            }\n        });\n    }\n\n    private setInteractive(interactive: boolean)\n    {\n        this.interactive = interactive;\n    }\n\n    private get layoutHeight(): number\n    {\n        return this.layout.height + (this.options.vertPadding * 2);\n    }\n\n    private get layoutWidth(): number\n    {\n        return this.layout.width + (this.options.horPadding * 2);\n    }\n\n    /** Controls item positions and visibility. */\n    public resize(): void\n    {\n        this.renderAllItems();\n\n        if (\n            this.borderMask\n            && (this.lastWidth !== this.layoutWidth\n                || this.lastHeight !== this.layoutHeight)\n        )\n        {\n            const verPadding = this.options.vertPadding;\n            const horPadding = this.options.horPadding;\n\n            if (!this.options.width)\n            {\n                this.__width += this.layoutWidth;\n            }\n\n            if (!this.options.height)\n            {\n                this.__height += this.layoutHeight;\n            }\n\n            this.borderMask\n                .clear()\n                .lineStyle(0)\n                .beginFill(0xffffff)\n                .drawRoundedRect(\n                    0,\n                    0,\n                    this.__width,\n                    this.__height,\n                    this.options.radius | 0,\n                );\n            removeHitBox(this.borderMask);\n\n            if (\n                this.background instanceof Graphics\n                && typeof this.options.background === 'number'\n            )\n            {\n                this.background\n                    .clear()\n                    .lineStyle(0)\n                    .beginFill(this.options.background)\n                    .drawRect(\n                        0,\n                        0,\n                        this.__width + horPadding,\n                        this.__height + verPadding,\n                    );\n            }\n\n            if (this.options.type === 'horizontal')\n            {\n                this.setInteractive(this.layoutWidth > this.__width);\n            }\n            else\n            {\n                this.setInteractive(this.layoutHeight > this.__height);\n            }\n\n            this.lastWidth = this.layoutWidth;\n            this.lastHeight = this.layoutHeight;\n        }\n\n        if (this._trackpad)\n        {\n            const maxWidth\n                = this.borderMask.width\n                - this.layout.width\n                - (this.options.horPadding * 2);\n\n            const maxHeight\n                = this.borderMask.height\n                - this.layout.height\n                - (this.options.vertPadding * 2);\n\n            if (this.options.type === 'vertical')\n            {\n                this._trackpad.yAxis.max = -Math.abs(maxHeight);\n            }\n            else if (this.options.type === 'horizontal')\n            {\n                this._trackpad.xAxis.max = -Math.abs(maxWidth);\n            }\n            else\n            {\n                this._trackpad.yAxis.max = -Math.abs(maxHeight);\n                this._trackpad.xAxis.max = -Math.abs(maxWidth);\n            }\n        }\n\n        this.stopRenderHiddenItems();\n    }\n\n    private onMouseHover()\n    {\n        this.renderAllItems();\n\n        document.addEventListener('mousewheel', this.onMouseScrollBinded);\n        document.addEventListener('DOMMouseScroll', this.onMouseScrollBinded);\n    }\n\n    private onMouseOut()\n    {\n        this.stopRenderHiddenItems();\n\n        document.removeEventListener('mousewheel', this.onMouseScrollBinded);\n        document.removeEventListener(\n            'DOMMouseScroll',\n            this.onMouseScrollBinded,\n        );\n    }\n\n    private onMouseScroll(event: any): void\n    {\n        this.renderAllItems();\n\n        if (\n            this.options.type === 'horizontal'\n            && (typeof event.deltaX !== 'undefined'\n                || typeof event.deltaY !== 'undefined')\n        )\n        {\n            const targetPos = event.deltaY\n                ? this.layout.x - event.deltaY\n                : this.layout.x - event.deltaX;\n\n            if (\n                targetPos < 0\n                && targetPos + this.layoutWidth + this.options.horPadding\n                    < this.__width\n            )\n            {\n                this._trackpad.xAxis.value = this.__width - this.layoutWidth;\n            }\n            else if (targetPos > this.options.horPadding)\n            {\n                this._trackpad.xAxis.value = 0;\n            }\n            else\n            {\n                this._trackpad.xAxis.value = targetPos;\n            }\n        }\n        else if (typeof event.deltaY !== 'undefined')\n        {\n            const targetPos = this.layout.y - event.deltaY;\n\n            if (\n                targetPos < 0\n                && targetPos + this.layoutHeight + this.options.vertPadding\n                    < this.__height\n            )\n            {\n                this._trackpad.yAxis.value = this.__height - this.layoutHeight;\n            }\n            else if (targetPos > this.options.vertPadding)\n            {\n                this._trackpad.yAxis.value = 0;\n            }\n            else\n            {\n                this._trackpad.yAxis.value = targetPos;\n            }\n        }\n\n        this.stopRenderHiddenItems();\n    }\n\n    /** Makes it scroll down to the last element. */\n    public scrollBottom()\n    {\n        if (!this.interactive)\n        {\n            this.scrollTop();\n        }\n        else\n        {\n            this.scrollTo(this.layout.children.length - 1);\n        }\n    }\n\n    /** Makes it scroll up to the first element. */\n    public scrollTop()\n    {\n        this._trackpad.xAxis.value = 0;\n        this._trackpad.yAxis.value = 0;\n    }\n\n    private renderAllItems()\n    {\n        if (this.options.disableDynamicRendering)\n        {\n            return;\n        }\n\n        this.items.forEach((child) =>\n        {\n            child.renderable = true;\n        });\n    }\n\n    private stopRenderHiddenItems()\n    {\n        if (this.options.disableDynamicRendering)\n        {\n            return;\n        }\n\n        this.items.forEach((child) =>\n        {\n            child.renderable = this.isItemVisible(child);\n        });\n    }\n\n    /**\n     * Scrolls to the element with the given ID.\n     * @param elementID\n     */\n    public scrollTo(elementID: number)\n    {\n        if (!this.interactive)\n        {\n            return;\n        }\n\n        const target = this.layout.children[elementID];\n\n        if (!target)\n        {\n            return;\n        }\n\n        this._trackpad.xAxis.value\n            = this.options.type === 'horizontal'\n                ? this.__width\n                  - target.x\n                  - target.width\n                  - this.options.horPadding\n                : 0;\n\n        this._trackpad.yAxis.value\n            = !this.options.type || this.options.type === 'vertical'\n                ? this.__height\n                  - target.y\n                  - target.height\n                  - this.options.vertPadding\n                : 0;\n    }\n\n    /** Gets component height. */\n    public override get height(): number\n    {\n        return this.__height;\n    }\n\n    /** Gets component width. */\n    public override get width(): number\n    {\n        return this.__width;\n    }\n\n    private update()\n    {\n        this._trackpad.update();\n\n        if (this.options.type === 'horizontal')\n        {\n            if (this.layout.x !== this._trackpad.x)\n            {\n                this.renderAllItems();\n                this.layout.x = this._trackpad.x;\n            }\n            else\n            {\n                this.stopRenderHiddenItems();\n            }\n        }\n        else\n        if (this.layout.y !== this._trackpad.y)\n        {\n            this.renderAllItems();\n            this.layout.y = this._trackpad.y;\n        }\n        else\n        {\n            this.stopRenderHiddenItems();\n        }\n    }\n}\n"],"names":[],"mappings":"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"}