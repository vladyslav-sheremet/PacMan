'use strict';

var display = require('@pixi/display');
var graphics = require('@pixi/graphics');
var view = require('./utils/helpers/view.js');

class ProgressBar extends display.Container {
  constructor({ bg, fill, fillOffset, progress }) {
    super();
    /** Start point of progress. */
    this.progressStart = 0;
    /** Current progress value. */
    this._progress = 0;
    this.innerView = new display.Container();
    this.addChild(this.innerView);
    this.bg = new display.Container();
    this.bg.addChild(view.getView(bg));
    this.innerView.addChild(this.bg);
    if (fill) {
      this.fill = new display.Container();
      this.fill.addChild(view.getView(fill));
      const offsetX = fillOffset?.x ?? 0;
      const offsetY = fillOffset?.y ?? 0;
      this.fill.x = (this.bg.width - this.fill.width) / 2 + offsetX;
      this.fill.y = (this.bg.height - this.fill.height) / 2 + offsetY;
      this.fillMask = new graphics.Graphics();
      this.fill.addChild(this.fillMask);
      this.fill.mask = this.fillMask;
      this.addChild(this.fill);
    }
    this.progress = progress;
  }
  validate(progress) {
    progress = Math.round(progress);
    if (progress < 0) {
      return 0;
    }
    if (progress > 100) {
      return 100;
    }
    return progress;
  }
  /** Sets current progress value. */
  set progress(progress) {
    this._progress = this.validate(progress);
    const startPoint = this.bg.width / 100 * this.progressStart;
    const endPoint = this.bg.width / 100 * this._progress - startPoint;
    if (this.fillMask) {
      this.fillMask.clear().lineStyle(0).beginFill(16777215).drawRect(startPoint, 0, endPoint, this.fill.height);
    }
  }
  /** Returns current progress value. */
  get progress() {
    return this._progress;
  }
}

exports.ProgressBar = ProgressBar;
//# sourceMappingURL=ProgressBar.js.map
